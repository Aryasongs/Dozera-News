<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dozera News - New York's Premier News Source</title>
    <meta name="description" content="Stay informed with Dozera News - New York's trusted source for politics, business, sports, and local news.">
    <meta name="keywords" content="New York news, politics, business, sports, local news, breaking news">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        .font-headline { font-family: 'Playfair Display', serif; }
        .font-body { font-family: 'Source Sans Pro', sans-serif; }
        .secret-admin-trigger {
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 20px;
            opacity: 0;
            cursor: pointer;
            z-index: 1000;
        }
        .admin-panel-hidden { display: none; }
        .user-panel-hidden { display: none; }
        .news-card:hover {
            transform: translateY(-2px);
            transition: transform 0.3s ease;
        }
        .provider-btn {
            transition: all 0.3s ease;
        }
        .provider-btn:hover {
            transform: scale(1.05);
        }
        .breaking-news {
            background: linear-gradient(90deg, #dc2626, #b91c1c);
            animation: pulse 2s infinite;
        }
        .featured-article {
            border-left: 4px solid #dc2626;
        }
        .article-meta {
            font-size: 0.875rem;
            color: #6b7280;
        }
        .category-politics { background-color: #3b82f6; }
        .category-business { background-color: #10b981; }
        .category-sports { background-color: #f59e0b; }
        .category-local { background-color: #8b5cf6; }
        .category-breaking { background-color: #dc2626; }
        
        .status-pending { background-color: #fbbf24; color: #92400e; }
        .status-approved { background-color: #10b981; color: #065f46; }
        .status-rejected { background-color: #ef4444; color: #991b1b; }
        .status-draft { background-color: #6b7280; color: #374151; }
    </style>
</head>
<body class="bg-gray-50 font-body">
    <!-- Secret Admin Trigger (invisible) -->
    <div class="secret-admin-trigger" onclick="handleSecretClick()"></div>
    
    <!-- Top Bar -->
    <div class="bg-black text-white text-sm py-2">
        <div class="max-w-7xl mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <span id="current-date"></span>
                <span class="text-gray-400">|</span>
                <span>New York, NY</span>
            </div>
            <div class="flex items-center space-x-4">
                <div id="user-auth-section">
                    <button onclick="showUserLogin()" class="text-white hover:text-gray-300 transition duration-200">
                        <i class="fas fa-user mr-1"></i>Sign In
                    </button>
                </div>
                <div id="user-logged-in-section" class="hidden">
                    <span class="text-gray-300">Welcome, <span id="user-display-name"></span></span>
                    <button onclick="showUserDashboard()" class="ml-3 text-white hover:text-gray-300">
                        <i class="fas fa-tachometer-alt mr-1"></i>Dashboard
                    </button>
                    <button onclick="userLogout()" class="ml-3 text-white hover:text-gray-300">
                        <i class="fas fa-sign-out-alt mr-1"></i>Logout
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Breaking News Ticker -->
    <div class="breaking-news text-white py-2 overflow-hidden">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center">
                <span class="bg-white text-red-600 px-3 py-1 text-xs font-bold rounded mr-4">BREAKING</span>
                <div class="flex-1 whitespace-nowrap">
                    <span class="animate-pulse">NYC Infrastructure Plan Approved • Wall Street Hits Record High • Yankees Advance to Playoffs</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Header -->
    <header class="bg-white border-b-2 border-black">
        <div class="max-w-7xl mx-auto px-4 py-6">
            <div class="text-center">
                <h1 class="font-headline text-6xl font-black text-black mb-2">Dozera News</h1>
                <p class="text-sm text-gray-600 font-medium tracking-wider uppercase">New York's Premier News Source</p>
                <div class="mt-4 text-xs text-gray-500">
                    <span>Founded 2024</span>
                    <span class="mx-2">•</span>
                    <span>All The News That's Fit To Print</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-center items-center py-3">
                <div class="flex items-center space-x-8">
                    <button onclick="showCategory('all')" class="nav-link text-black hover:text-red-600 font-semibold text-sm uppercase tracking-wide border-b-2 border-transparent hover:border-red-600 pb-1 transition duration-200">Home</button>
                    <button onclick="showCategory('politics')" class="nav-link text-black hover:text-red-600 font-semibold text-sm uppercase tracking-wide border-b-2 border-transparent hover:border-red-600 pb-1 transition duration-200">Politics</button>
                    <button onclick="showCategory('business')" class="nav-link text-black hover:text-red-600 font-semibold text-sm uppercase tracking-wide border-b-2 border-transparent hover:border-red-600 pb-1 transition duration-200">Business</button>
                    <button onclick="showCategory('sports')" class="nav-link text-black hover:text-red-600 font-semibold text-sm uppercase tracking-wide border-b-2 border-transparent hover:border-red-600 pb-1 transition duration-200">Sports</button>
                    <button onclick="showCategory('local')" class="nav-link text-black hover:text-red-600 font-semibold text-sm uppercase tracking-wide border-b-2 border-transparent hover:border-red-600 pb-1 transition duration-200">Local</button>
                    <button onclick="showCategory('opinion')" class="nav-link text-black hover:text-red-600 font-semibold text-sm uppercase tracking-wide border-b-2 border-transparent hover:border-red-600 pb-1 transition duration-200">Opinion</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8">
        <!-- Featured Story -->
        <section class="mb-12">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                    <div class="featured-article bg-white p-8 shadow-sm">
                        <div class="mb-4">
                            <span class="category-politics text-white px-3 py-1 text-xs font-bold rounded uppercase">Politics</span>
                        </div>
                        <h2 class="font-headline text-4xl font-bold text-black mb-4 leading-tight">NYC Mayor Announces Comprehensive Infrastructure Overhaul</h2>
                        <p class="text-lg text-gray-700 mb-6 leading-relaxed">A groundbreaking $50 billion initiative promises to transform New York City's aging infrastructure, focusing on transportation, utilities, and digital connectivity for the next decade.</p>
                        <div class="article-meta flex items-center space-x-4">
                            <span>By <strong>Sarah Johnson</strong></span>
                            <span>•</span>
                            <span>Today, 2:30 PM</span>
                            <span>•</span>
                            <span>5 min read</span>
                        </div>
                    </div>
                </div>
                <div class="space-y-6">
                    <div class="bg-white p-6 shadow-sm">
                        <span class="category-business text-white px-2 py-1 text-xs font-bold rounded uppercase">Business</span>
                        <h3 class="font-headline text-xl font-bold mt-3 mb-2">Wall Street Reaches New Heights</h3>
                        <p class="text-gray-600 text-sm mb-3">Record trading volumes signal investor confidence in economic recovery.</p>
                        <div class="article-meta">
                            <span>By Michael Chen • 1 hour ago</span>
                        </div>
                    </div>
                    <div class="bg-white p-6 shadow-sm">
                        <span class="category-sports text-white px-2 py-1 text-xs font-bold rounded uppercase">Sports</span>
                        <h3 class="font-headline text-xl font-bold mt-3 mb-2">Yankees Clinch Division Title</h3>
                        <p class="text-gray-600 text-sm mb-3">Dominant performance secures playoff berth for the Bronx Bombers.</p>
                        <div class="article-meta">
                            <span>By David Rodriguez • 3 hours ago</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- News Grid -->
        <section id="news-container">
            <div class="border-t-2 border-black pt-8">
                <h2 class="font-headline text-3xl font-bold text-black mb-8">Latest News</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="news-grid">
                    <!-- News articles will be loaded here -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-black text-white mt-16">
        <div class="max-w-7xl mx-auto px-4 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="font-headline text-2xl font-bold mb-4">Dozera News</h3>
                    <p class="text-gray-400 text-sm">New York's premier source for breaking news, politics, business, and local stories.</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Sections</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white">Politics</a></li>
                        <li><a href="#" class="hover:text-white">Business</a></li>
                        <li><a href="#" class="hover:text-white">Sports</a></li>
                        <li><a href="#" class="hover:text-white">Local</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Company</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white">About Us</a></li>
                        <li><a href="#" class="hover:text-white">Contact</a></li>
                        <li><a href="#" class="hover:text-white">Careers</a></li>
                        <li><a href="#" class="hover:text-white">Privacy Policy</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Follow Us</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter text-xl"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook text-xl"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-instagram text-xl"></i></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-sm text-gray-400">
                <p>&copy; 2024 Dozera News. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- User Login Modal -->
    <div id="user-login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-900">Sign In to Dozera News</h3>
                    <button onclick="closeUserModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- Firebase Auth Providers -->
                <div id="user-auth-providers" class="space-y-3">
                    <button onclick="userSignInWithGoogle()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                        <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google" class="w-5 h-5 mr-3">
                        <span class="font-medium">Continue with Google</span>
                    </button>
                    
                    <button onclick="userSignInWithGitHub()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                        <i class="fab fa-github text-xl mr-3"></i>
                        <span class="font-medium">Continue with GitHub</span>
                    </button>
                    
                    <button onclick="userSignInWithTwitter()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                        <i class="fab fa-twitter text-xl mr-3 text-blue-400"></i>
                        <span class="font-medium">Continue with Twitter</span>
                    </button>
                    
                    <button onclick="showUserEmailAuth()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                        <i class="fas fa-envelope text-xl mr-3 text-gray-600"></i>
                        <span class="font-medium">Continue with Email</span>
                    </button>
                    
                    <button onclick="userSignInWithPhone()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                        <i class="fas fa-phone text-xl mr-3 text-green-600"></i>
                        <span class="font-medium">Continue with Phone</span>
                    </button>
                    
                    <button onclick="userSignInAnonymously()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                        <i class="fas fa-user-secret text-xl mr-3 text-gray-600"></i>
                        <span class="font-medium">Continue as Guest</span>
                    </button>
                </div>

                <!-- Email Auth Form -->
                <div id="user-email-auth-form" class="hidden">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" id="user-email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                            <input type="password" id="user-password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="userSignInWithEmail()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200">Sign In</button>
                            <button onclick="userSignUpWithEmail()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200">Sign Up</button>
                        </div>
                        <button onclick="showUserAuthProviders()" class="w-full text-sm text-blue-600 hover:text-blue-800">← Back to providers</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="admin-login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-900">Admin Access</h3>
                    <button onclick="closeAdminModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- Access Code Input -->
                <div id="access-code-step" class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Enter Access Code</label>
                    <input type="password" id="access-code" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Access Code">
                    <button onclick="verifyAccessCode()" class="w-full mt-3 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200">Verify Code</button>
                </div>

                <!-- Firebase Auth Providers -->
                <div id="admin-auth-providers-step" class="hidden">
                    <p class="text-sm text-gray-600 mb-4">Choose your authentication method:</p>
                    
                    <div class="space-y-3">
                        <button onclick="adminSignInWithGoogle()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                            <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google" class="w-5 h-5 mr-3">
                            <span class="font-medium">Continue with Google</span>
                        </button>
                        
                        <button onclick="adminSignInWithGitHub()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                            <i class="fab fa-github text-xl mr-3"></i>
                            <span class="font-medium">Continue with GitHub</span>
                        </button>
                        
                        <button onclick="adminSignInWithTwitter()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                            <i class="fab fa-twitter text-xl mr-3 text-blue-400"></i>
                            <span class="font-medium">Continue with Twitter</span>
                        </button>
                        
                        <button onclick="showAdminEmailAuth()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                            <i class="fas fa-envelope text-xl mr-3 text-gray-600"></i>
                            <span class="font-medium">Continue with Email</span>
                        </button>
                        
                        <button onclick="adminSignInWithPhone()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                            <i class="fas fa-phone text-xl mr-3 text-green-600"></i>
                            <span class="font-medium">Continue with Phone</span>
                        </button>
                        
                        <button onclick="adminSignInAnonymously()" class="provider-btn w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50">
                            <i class="fas fa-user-secret text-xl mr-3 text-gray-600"></i>
                            <span class="font-medium">Continue Anonymously</span>
                        </button>
                    </div>
                </div>

                <!-- Email Auth Form -->
                <div id="admin-email-auth-form" class="hidden">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" id="admin-email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                            <input type="password" id="admin-password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="adminSignInWithEmail()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200">Sign In</button>
                            <button onclick="adminSignUpWithEmail()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200">Sign Up</button>
                        </div>
                        <button onclick="showAdminAuthProviders()" class="w-full text-sm text-blue-600 hover:text-blue-800">← Back to providers</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- User Dashboard -->
    <div id="user-panel" class="user-panel-hidden fixed inset-0 bg-gray-100 z-40">
        <!-- User Sidebar -->
        <div class="bg-white w-64 h-full shadow-lg fixed left-0 top-0 z-50">
            <div class="p-6 border-b">
                <h2 class="text-xl font-bold text-gray-900">User Dashboard</h2>
                <p class="text-sm text-gray-600" id="user-panel-name">Welcome back!</p>
            </div>
            
            <nav class="mt-6">
                <button onclick="showUserSection('my-articles')" class="user-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-newspaper mr-3"></i>My Articles
                </button>
                <button onclick="showUserSection('write-article')" class="user-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-pen mr-3"></i>Write Article
                </button>
                <button onclick="showUserSection('profile')" class="user-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-user mr-3"></i>Profile
                </button>
            </nav>
            
            <div class="absolute bottom-0 left-0 right-0 p-6 border-t">
                <button onclick="hideUserPanel()" class="w-full bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition duration-200 mb-2">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Site
                </button>
                <button onclick="userLogout()" class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition duration-200">
                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                </button>
            </div>
        </div>

        <!-- User Content -->
        <div class="ml-64 p-8">
            <!-- My Articles Section -->
            <div id="user-my-articles" class="user-section">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">My Articles</h3>
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="user-articles-table" class="bg-white divide-y divide-gray-200">
                            <!-- User articles will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Write Article Section -->
            <div id="user-write-article" class="user-section hidden">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">Write New Article</h3>
                <div class="bg-white rounded-lg shadow p-6">
                    <form id="user-article-form" class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                            <input type="text" id="user-article-title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                                <select id="user-article-category" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="politics">Politics</option>
                                    <option value="business">Business</option>
                                    <option value="sports">Sports</option>
                                    <option value="local">Local</option>
                                    <option value="opinion">Opinion</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                                <input type="text" id="user-article-tags" placeholder="Separate tags with commas" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Summary</label>
                            <textarea id="user-article-summary" rows="3" placeholder="Brief summary of your article..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Content</label>
                            <textarea id="user-article-content" rows="15" placeholder="Write your article content here..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        
                        <div class="flex space-x-4">
                            <button type="button" onclick="saveUserArticle('draft')" class="bg-gray-600 text-white px-6 py-2 rounded-md hover:bg-gray-700 transition duration-200">
                                <i class="fas fa-save mr-2"></i>Save as Draft
                            </button>
                            <button type="button" onclick="saveUserArticle('pending')" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition duration-200">
                                <i class="fas fa-paper-plane mr-2"></i>Submit for Review
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="user-profile" class="user-section hidden">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">Profile Settings</h3>
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Display Name</label>
                            <input type="text" id="user-display-name-input" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Bio</label>
                            <textarea id="user-bio" rows="4" placeholder="Tell us about yourself..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <button onclick="updateUserProfile()" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition duration-200">
                            <i class="fas fa-save mr-2"></i>Update Profile
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin-panel" class="admin-panel-hidden fixed inset-0 bg-gray-100 z-40">
        <!-- Admin Sidebar -->
        <div class="bg-white w-64 h-full shadow-lg fixed left-0 top-0 z-50">
            <div class="p-6 border-b">
                <h2 class="text-xl font-bold text-gray-900">Admin Panel</h2>
                <p class="text-sm text-gray-600">Dozera News</p>
            </div>
            
            <nav class="mt-6">
                <button onclick="showAdminSection('dashboard')" class="admin-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-tachometer-alt mr-3"></i>Dashboard
                </button>
                <button onclick="showAdminSection('pending-articles')" class="admin-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-clock mr-3"></i>Pending Articles
                    <span id="pending-count" class="ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full">0</span>
                </button>
                <button onclick="showAdminSection('all-articles')" class="admin-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-newspaper mr-3"></i>All Articles
                </button>
                <button onclick="showAdminSection('users')" class="admin-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-users mr-3"></i>Users
                </button>
                <button onclick="showAdminSection('settings')" class="admin-nav-btn w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-900 border-l-4 border-transparent hover:border-blue-500">
                    <i class="fas fa-cog mr-3"></i>Settings
                </button>
            </nav>
            
            <div class="absolute bottom-0 left-0 right-0 p-6 border-t">
                <button onclick="adminLogout()" class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition duration-200">
                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                </button>
            </div>
        </div>

        <!-- Admin Content -->
        <div class="ml-64 p-8">
            <!-- Dashboard Section -->
            <div id="admin-dashboard" class="admin-section">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">Admin Dashboard</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 bg-blue-100 rounded-full">
                                <i class="fas fa-newspaper text-blue-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Published Articles</p>
                                <p class="text-2xl font-bold text-gray-900" id="published-articles">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 bg-yellow-100 rounded-full">
                                <i class="fas fa-clock text-yellow-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Pending Review</p>
                                <p class="text-2xl font-bold text-gray-900" id="pending-articles">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 bg-green-100 rounded-full">
                                <i class="fas fa-users text-green-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Total Users</p>
                                <p class="text-2xl font-bold text-gray-900" id="total-users">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 bg-purple-100 rounded-full">
                                <i class="fas fa-eye text-purple-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Page Views</p>
                                <p class="text-2xl font-bold text-gray-900">12,345</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pending Articles Section -->
            <div id="admin-pending-articles" class="admin-section hidden">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">Pending Articles</h3>
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Author</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pending-articles-table" class="bg-white divide-y divide-gray-200">
                            <!-- Pending articles will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- All Articles Section -->
            <div id="admin-all-articles" class="admin-section hidden">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">All Articles</h3>
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Author</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="all-articles-table" class="bg-white divide-y divide-gray-200">
                            <!-- All articles will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Users Section -->
            <div id="admin-users" class="admin-section hidden">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">User Management</h3>
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Articles</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table" class="bg-white divide-y divide-gray-200">
                            <!-- Users will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="admin-settings" class="admin-section hidden">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">Site Settings</h3>
                <div class="bg-white rounded-lg shadow p-6">
                    <p class="text-gray-600">Site configuration options coming soon...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA2aDGTKSbkeFnG5aAPPVGkGk3-JOsfbDQ",
            authDomain: "dozeranews.firebaseapp.com",
            projectId: "dozeranews",
            storageBucket: "dozeranews.firebasestorage.app",
            messagingSenderId: "162732208376",
            appId: "1:162732208376:web:6a0fe4df447b2e9a090b0d"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Global variables
        let currentUser = null;
        let isAdmin = false;
        let secretClickCount = 0;
        let secretTimeout = null;
        let userArticles = [];
        let allArticles = [];

        // Sample data
        const sampleNews = [
            {
                id: '1',
                title: 'NYC Mayor Announces New Infrastructure Plan',
                summary: 'A comprehensive $50 billion plan to modernize New York City\'s infrastructure over the next decade.',
                content: 'New York City Mayor announced today a groundbreaking infrastructure plan that will transform the city\'s transportation, utilities, and digital infrastructure. The plan includes upgrades to the subway system, expansion of bike lanes, and citywide fiber optic installation.',
                category: 'politics',
                author: 'Sarah Johnson',
                authorId: 'admin',
                date: new Date().toISOString(),
                status: 'published',
                tags: ['infrastructure', 'nyc', 'politics']
            },
            {
                id: '2',
                title: 'Wall Street Sees Record Trading Volume',
                summary: 'Stock exchanges report highest daily trading volume in five years amid market volatility.',
                content: 'Wall Street experienced unprecedented trading activity today as investors responded to new economic indicators. The NYSE and NASDAQ both reported record-breaking volumes, with technology stocks leading the surge.',
                category: 'business',
                author: 'Michael Chen',
                authorId: 'admin',
                date: new Date(Date.now() - 86400000).toISOString(),
                status: 'published',
                tags: ['wall street', 'trading', 'stocks']
            }
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentDate();
            loadNews();
            setupAuthStateListener();
        });

        // Update current date
        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('current-date').textContent = now.toLocaleDateString('en-US', options);
        }

        // Secret admin access
        function handleSecretClick() {
            secretClickCount++;
            clearTimeout(secretTimeout);
            
            if (secretClickCount >= 5) {
                document.getElementById('admin-login-modal').classList.remove('hidden');
                secretClickCount = 0;
            } else {
                secretTimeout = setTimeout(() => {
                    secretClickCount = 0;
                }, 2000);
            }
        }

        // Access code verification
        function verifyAccessCode() {
            const code = document.getElementById('access-code').value;
            if (code === '20060202') {
                document.getElementById('access-code-step').classList.add('hidden');
                document.getElementById('admin-auth-providers-step').classList.remove('hidden');
            } else {
                alert('Invalid access code');
            }
        }

        // Firebase Auth State Listener
        function setupAuthStateListener() {
            auth.onAuthStateChanged(async (user) => {
                currentUser = user;
                if (user) {
                    // Check if user has admin privileges
                    try {
                        const token = await user.getIdTokenResult();
                        isAdmin = token.claims.admin === true;
                        
                        // Update UI based on auth state
                        document.getElementById('user-auth-section').classList.add('hidden');
                        document.getElementById('user-logged-in-section').classList.remove('hidden');
                        document.getElementById('user-display-name').textContent = user.displayName || user.email || 'User';
                        
                        if (isAdmin) {
                            closeAdminModal();
                            showAdminPanel();
                        }
                    } catch (error) {
                        console.error('Error getting token:', error);
                    }
                } else {
                    // User is signed out
                    document.getElementById('user-auth-section').classList.remove('hidden');
                    document.getElementById('user-logged-in-section').classList.add('hidden');
                    hideUserPanel();
                    hideAdminPanel();
                    isAdmin = false;
                }
            });
        }

        // User Authentication Functions
        function showUserLogin() {
            document.getElementById('user-login-modal').classList.remove('hidden');
        }

        function closeUserModal() {
            document.getElementById('user-login-modal').classList.add('hidden');
            document.getElementById('user-auth-providers').classList.remove('hidden');
            document.getElementById('user-email-auth-form').classList.add('hidden');
        }

        function showUserEmailAuth() {
            document.getElementById('user-auth-providers').classList.add('hidden');
            document.getElementById('user-email-auth-form').classList.remove('hidden');
        }

        function showUserAuthProviders() {
            document.getElementById('user-email-auth-form').classList.add('hidden');
            document.getElementById('user-auth-providers').classList.remove('hidden');
        }

        async function userSignInWithGoogle() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                await auth.signInWithPopup(provider);
                closeUserModal();
            } catch (error) {
                console.error('Google sign-in error:', error);
                alert('Sign-in failed. Please try again.');
            }
        }

        async function userSignInWithGitHub() {
            try {
                const provider = new firebase.auth.GithubAuthProvider();
                await auth.signInWithPopup(provider);
                closeUserModal();
            } catch (error) {
                console.error('GitHub sign-in error:', error);
                alert('Sign-in failed. Please try again.');
            }
        }

        async function userSignInWithTwitter() {
            try {
                const provider = new firebase.auth.TwitterAuthProvider();
                await auth.signInWithPopup(provider);
                closeUserModal();
            } catch (error) {
                console.error('Twitter sign-in error:', error);
                alert('Sign-in failed. Please try again.');
            }
        }

        async function userSignInWithEmail() {
            const email = document.getElementById('user-email').value;
            const password = document.getElementById('user-password').value;
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                closeUserModal();
            } catch (error) {
                console.error('Email sign-in error:', error);
                alert('Sign-in failed. Please check your credentials.');
            }
        }

        async function userSignUpWithEmail() {
            const email = document.getElementById('user-email').value;
            const password = document.getElementById('user-password').value;
            
            try {
                await auth.createUserWithEmailAndPassword(email, password);
                closeUserModal();
            } catch (error) {
                console.error('Email sign-up error:', error);
                alert('Sign-up failed. Please try again.');
            }
        }

        async function userSignInWithPhone() {
            alert('Phone authentication requires additional configuration. Please use another method.');
        }

        async function userSignInAnonymously() {
            try {
                await auth.signInAnonymously();
                closeUserModal();
            } catch (error) {
                console.error('Anonymous sign-in error:', error);
                alert('Anonymous sign-in failed. Please try again.');
            }
        }

        async function userLogout() {
            try {
                await auth.signOut();
                hideUserPanel();
                hideAdminPanel();
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // Admin Authentication Functions
        function closeAdminModal() {
            document.getElementById('admin-login-modal').classList.add('hidden');
            document.getElementById('access-code-step').classList.remove('hidden');
            document.getElementById('admin-auth-providers-step').classList.add('hidden');
            document.getElementById('admin-email-auth-form').classList.add('hidden');
            document.getElementById('access-code').value = '';
        }

        function showAdminEmailAuth() {
            document.getElementById('admin-auth-providers-step').classList.add('hidden');
            document.getElementById('admin-email-auth-form').classList.remove('hidden');
        }

        function showAdminAuthProviders() {
            document.getElementById('admin-email-auth-form').classList.add('hidden');
            document.getElementById('admin-auth-providers-step').classList.remove('hidden');
        }

        async function adminSignInWithGoogle() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                await auth.signInWithPopup(provider);
            } catch (error) {
                console.error('Google sign-in error:', error);
                alert('Sign-in failed. Please try again.');
            }
        }

        async function adminSignInWithGitHub() {
            try {
                const provider = new firebase.auth.GithubAuthProvider();
                await auth.signInWithPopup(provider);
            } catch (error) {
                console.error('GitHub sign-in error:', error);
                alert('Sign-in failed. Please try again.');
            }
        }

        async function adminSignInWithTwitter() {
            try {
                const provider = new firebase.auth.TwitterAuthProvider();
                await auth.signInWithPopup(provider);
            } catch (error) {
                console.error('Twitter sign-in error:', error);
                alert('Sign-in failed. Please try again.');
            }
        }

        async function adminSignInWithEmail() {
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
            } catch (error) {
                console.error('Email sign-in error:', error);
                alert('Sign-in failed. Please check your credentials.');
            }
        }

        async function adminSignUpWithEmail() {
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            
            try {
                await auth.createUserWithEmailAndPassword(email, password);
            } catch (error) {
                console.error('Email sign-up error:', error);
                alert('Sign-up failed. Please try again.');
            }
        }

        async function adminSignInWithPhone() {
            alert('Phone authentication requires additional configuration. Please use another method.');
        }

        async function adminSignInAnonymously() {
            try {
                await auth.signInAnonymously();
            } catch (error) {
                console.error('Anonymous sign-in error:', error);
                alert('Anonymous sign-in failed. Please try again.');
            }
        }

        async function adminLogout() {
            try {
                await auth.signOut();
                hideAdminPanel();
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // User Dashboard Functions
        function showUserDashboard() {
            if (!currentUser) {
                showUserLogin();
                return;
            }
            document.getElementById('user-panel').classList.remove('user-panel-hidden');
            document.getElementById('user-panel-name').textContent = `Welcome, ${currentUser.displayName || currentUser.email || 'User'}!`;
            loadUserArticles();
            showUserSection('my-articles');
        }

        function hideUserPanel() {
            document.getElementById('user-panel').classList.add('user-panel-hidden');
        }

        function showUserSection(section) {
            // Hide all sections
            document.querySelectorAll('.user-section').forEach(el => el.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(`user-${section}`).classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.user-nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-50', 'text-blue-900', 'border-blue-500');
            });
            event.target.classList.add('bg-blue-50', 'text-blue-900', 'border-blue-500');
        }

        function loadUserArticles() {
            if (!currentUser) return;
            
            // Filter articles by current user
            const userArticlesList = allArticles.filter(article => article.authorId === currentUser.uid);
            
            const tbody = document.getElementById('user-articles-table');
            tbody.innerHTML = '';
            
            if (userArticlesList.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="px-6 py-4 text-center text-gray-500">No articles yet. Start writing!</td></tr>';
                return;
            }
            
            userArticlesList.forEach(article => {
                const row = document.createElement('tr');
                const statusClass = `status-${article.status}`;
                
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900">${article.title}</div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                            ${article.status.toUpperCase()}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-500">
                        ${new Date(article.date).toLocaleDateString()}
                    </td>
                    <td class="px-6 py-4 text-sm font-medium">
                        ${article.status === 'draft' || article.status === 'rejected' ? 
                            `<button onclick="editUserArticle('${article.id}')" class="text-blue-600 hover:text-blue-900 mr-3">Edit</button>` : 
                            '<span class="text-gray-400">Published</span>'
                        }
                        <button onclick="deleteUserArticle('${article.id}')" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function saveUserArticle(status) {
            if (!currentUser) {
                alert('Please sign in to save articles');
                return;
            }
            
            const title = document.getElementById('user-article-title').value;
            const category = document.getElementById('user-article-category').value;
            const tags = document.getElementById('user-article-tags').value;
            const summary = document.getElementById('user-article-summary').value;
            const content = document.getElementById('user-article-content').value;
            
            if (!title || !summary || !content) {
                alert('Please fill in all required fields');
                return;
            }
            
            const articleData = {
                id: Date.now().toString(),
                title,
                category,
                tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag),
                summary,
                content,
                author: currentUser.displayName || currentUser.email || 'Anonymous',
                authorId: currentUser.uid,
                date: new Date().toISOString(),
                status: status
            };
            
            // Add to articles array (in real app, save to Firestore)
            allArticles.unshift(articleData);
            
            // Clear form
            document.getElementById('user-article-form').reset();
            
            // Refresh user articles
            loadUserArticles();
            
            // Show success message
            const statusText = status === 'draft' ? 'saved as draft' : 'submitted for review';
            alert(`Article ${statusText} successfully!`);
            
            // Switch to my articles view
            showUserSection('my-articles');
        }

        function editUserArticle(articleId) {
            const article = allArticles.find(a => a.id === articleId);
            if (!article) return;
            
            // Populate form with article data
            document.getElementById('user-article-title').value = article.title;
            document.getElementById('user-article-category').value = article.category;
            document.getElementById('user-article-tags').value = article.tags.join(', ');
            document.getElementById('user-article-summary').value = article.summary;
            document.getElementById('user-article-content').value = article.content;
            
            // Switch to write article view
            showUserSection('write-article');
            
            // Remove the old article (will be replaced when saved)
            const index = allArticles.findIndex(a => a.id === articleId);
            if (index > -1) {
                allArticles.splice(index, 1);
            }
        }

        function deleteUserArticle(articleId) {
            if (confirm('Are you sure you want to delete this article?')) {
                const index = allArticles.findIndex(a => a.id === articleId);
                if (index > -1) {
                    allArticles.splice(index, 1);
                    loadUserArticles();
                    loadNews(); // Refresh public view if published
                }
            }
        }

        function updateUserProfile() {
            if (!currentUser) return;
            
            const displayName = document.getElementById('user-display-name-input').value;
            const bio = document.getElementById('user-bio').value;
            
            // In real app, update Firebase user profile and Firestore
            currentUser.updateProfile({
                displayName: displayName
            }).then(() => {
                alert('Profile updated successfully!');
                document.getElementById('user-display-name').textContent = displayName;
                document.getElementById('user-panel-name').textContent = `Welcome, ${displayName}!`;
            }).catch((error) => {
                console.error('Error updating profile:', error);
                alert('Failed to update profile');
            });
        }

        // Admin Panel Functions
        function showAdminPanel() {
            document.getElementById('admin-panel').classList.remove('admin-panel-hidden');
            loadAdminData();
            showAdminSection('dashboard');
        }

        function hideAdminPanel() {
            document.getElementById('admin-panel').classList.add('admin-panel-hidden');
        }

        function showAdminSection(section) {
            // Hide all sections
            document.querySelectorAll('.admin-section').forEach(el => el.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(`admin-${section}`).classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-50', 'text-blue-900', 'border-blue-500');
            });
            event.target.classList.add('bg-blue-50', 'text-blue-900', 'border-blue-500');
        }

        function loadAdminData() {
            loadPendingArticles();
            loadAllArticlesAdmin();
            updateAdminStats();
        }

        function loadPendingArticles() {
            const pendingArticles = allArticles.filter(article => article.status === 'pending');
            const tbody = document.getElementById('pending-articles-table');
            tbody.innerHTML = '';
            
            document.getElementById('pending-count').textContent = pendingArticles.length;
            
            if (pendingArticles.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500">No pending articles</td></tr>';
                return;
            }
            
            pendingArticles.forEach(article => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900">${article.title}</div>
                        <div class="text-sm text-gray-500">${article.summary.substring(0, 100)}...</div>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-900">${article.author}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full category-${article.category}">
                            ${article.category}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-500">
                        ${new Date(article.date).toLocaleDateString()}
                    </td>
                    <td class="px-6 py-4 text-sm font-medium">
                        <button onclick="approveArticle('${article.id}')" class="text-green-600 hover:text-green-900 mr-3">Approve</button>
                        <button onclick="rejectArticle('${article.id}')" class="text-red-600 hover:text-red-900 mr-3">Reject</button>
                        <button onclick="viewArticle('${article.id}')" class="text-blue-600 hover:text-blue-900">View</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function loadAllArticlesAdmin() {
            const tbody = document.getElementById('all-articles-table');
            tbody.innerHTML = '';
            
            allArticles.forEach(article => {
                const row = document.createElement('tr');
                const statusClass = `status-${article.status}`;
                
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900">${article.title}</div>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-900">${article.author}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                            ${article.status.toUpperCase()}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-500">
                        ${new Date(article.date).toLocaleDateString()}
                    </td>
                    <td class="px-6 py-4 text-sm font-medium">
                        <button onclick="viewArticle('${article.id}')" class="text-blue-600 hover:text-blue-900 mr-3">View</button>
                        <button onclick="deleteArticleAdmin('${article.id}')" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateAdminStats() {
            const publishedCount = allArticles.filter(a => a.status === 'published').length;
            const pendingCount = allArticles.filter(a => a.status === 'pending').length;
            
            document.getElementById('published-articles').textContent = publishedCount;
            document.getElementById('pending-articles').textContent = pendingCount;
            document.getElementById('total-users').textContent = '1'; // Placeholder
        }

        function approveArticle(articleId) {
            const article = allArticles.find(a => a.id === articleId);
            if (article) {
                article.status = 'published';
                loadAdminData();
                loadNews(); // Refresh public view
                alert('Article approved and published!');
            }
        }

        function rejectArticle(articleId) {
            const reason = prompt('Reason for rejection (optional):');
            const article = allArticles.find(a => a.id === articleId);
            if (article) {
                article.status = 'rejected';
                article.rejectionReason = reason;
                loadAdminData();
                alert('Article rejected.');
            }
        }

        function viewArticle(articleId) {
            const article = allArticles.find(a => a.id === articleId);
            if (article) {
                alert(`Title: ${article.title}\n\nContent: ${article.content}`);
            }
        }

        function deleteArticleAdmin(articleId) {
            if (confirm('Are you sure you want to delete this article?')) {
                const index = allArticles.findIndex(a => a.id === articleId);
                if (index > -1) {
                    allArticles.splice(index, 1);
                    loadAdminData();
                    loadNews();
                }
            }
        }

        // News Display Functions
        function loadNews() {
            const newsGrid = document.getElementById('news-grid');
            newsGrid.innerHTML = '';
            
            // Combine sample news with published user articles
            const publishedArticles = [...sampleNews, ...allArticles.filter(a => a.status === 'published')];
            
            publishedArticles.forEach(article => {
                const articleCard = createNewsCard(article);
                newsGrid.appendChild(articleCard);
            });
        }

        function createNewsCard(article) {
            const card = document.createElement('div');
            card.className = 'news-card bg-white shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-300';
            
            const categoryColors = {
                politics: 'category-politics',
                business: 'category-business',
                sports: 'category-sports',
                local: 'category-local',
                opinion: 'category-opinion'
            };
            
            card.innerHTML = `
                <div class="p-6">
                    <div class="mb-3">
                        <span class="px-2 py-1 text-xs font-bold text-white rounded uppercase ${categoryColors[article.category] || 'bg-gray-600'}">
                            ${article.category}
                        </span>
                    </div>
                    <h3 class="font-headline text-xl font-bold text-black mb-3 leading-tight hover:text-red-600 cursor-pointer">${article.title}</h3>
                    <p class="text-gray-700 mb-4 leading-relaxed">${article.summary}</p>
                    <div class="article-meta flex items-center justify-between">
                        <span>By <strong>${article.author}</strong></span>
                        <span>${new Date(article.date).toLocaleDateString()}</span>
                    </div>
                </div>
            `;
            
            card.addEventListener('click', () => showArticleDetail(article));
            return card;
        }

        function showCategory(category) {
            const newsGrid = document.getElementById('news-grid');
            newsGrid.innerHTML = '';
            
            const publishedArticles = [...sampleNews, ...allArticles.filter(a => a.status === 'published')];
            const filteredNews = category === 'all' ? publishedArticles : publishedArticles.filter(article => article.category === category);
            
            filteredNews.forEach(article => {
                const articleCard = createNewsCard(article);
                newsGrid.appendChild(articleCard);
            });
        }

        function showArticleDetail(article) {
            // Create a modal or navigate to article detail page
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-4xl w-full max-h-screen overflow-y-auto">
                    <div class="p-8">
                        <div class="flex justify-between items-start mb-6">
                            <div>
                                <span class="px-3 py-1 text-xs font-bold text-white rounded uppercase category-${article.category}">
                                    ${article.category}
                                </span>
                                <h1 class="font-headline text-3xl font-bold text-black mt-4 mb-2">${article.title}</h1>
                                <div class="article-meta">
                                    <span>By <strong>${article.author}</strong> • ${new Date(article.date).toLocaleDateString()} • 5 min read</span>
                                </div>
                            </div>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-2xl"></i>
                            </button>
                        </div>
                        <div class="prose max-w-none">
                            <p class="text-lg text-gray-700 mb-6 leading-relaxed font-medium">${article.summary}</p>
                            <div class="text-gray-800 leading-relaxed whitespace-pre-line">${article.content}</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize with sample data
        allArticles = [...sampleNews];
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96d4ba70521191cd',t:'MTc1NDg4MzgwMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
